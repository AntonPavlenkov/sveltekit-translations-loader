# Deep Scanning Test Case

This test case demonstrates how the SvelteKit translations loader plugin now performs deep scanning to find translation keys in nested components.

## Test Structure

```
deep-scanning-test/
â”œâ”€â”€ +page.svelte                    # NO direct translation usage
â”œâ”€â”€ +page.server.ts                 # Will be auto-generated by plugin
â”œâ”€â”€ DeepScanningComponent.svelte    # Uses: hello, welcome, userCount
â”œâ”€â”€ NestedTranslationComponent.svelte # Uses: pageContent, goodbye + imports DeepNestedComponent
â””â”€â”€ DeepNestedComponent.svelte      # Uses: hello, welcome, continueFn
```

## Expected Behavior

### 1. Dev Server Startup

When you start the dev server, the plugin will:

1. **Scan `+page.svelte`** - Finds NO direct translation keys
2. **Follow imports** - Discovers `DeepScanningComponent` and `NestedTranslationComponent`
3. **Deep scan `DeepScanningComponent`** - Finds keys: `hello`, `welcome`, `userCount`
4. **Deep scan `NestedTranslationComponent`** - Finds keys: `pageContent`, `goodbye`
5. **Follow nested import** - Discovers `DeepNestedComponent`
6. **Deep scan `DeepNestedComponent`** - Finds keys: `hello`, `welcome`, `continueFn`

### 2. Translation Key Collection

The plugin will collect **ALL** translation keys from the entire component tree:

- `hello` (from DeepScanningComponent and DeepNestedComponent)
- `welcome` (from DeepScanningComponent and DeepNestedComponent)
- `userCount` / `user-count` (from DeepScanningComponent)
- `pageContent` / `page-content` (from NestedTranslationComponent)
- `goodbye` (from NestedTranslationComponent)
- `continueFn` / `continue` / `continue-fn` (from DeepNestedComponent)

### 3. Server File Generation

The plugin will automatically update `+page.server.ts` to include all discovered keys:

```typescript
// AUTO-GENERATED CODE BY SVELTEKIT-TRANSLATIONS-LOADER PLUGIN
import { _getTranslations } from '$lib/server';
const _translationKeys: string[] = [
	'hello',
	'welcome',
	'userCount',
	'user-count',
	'pageContent',
	'page-content',
	'goodbye',
	'continueFn',
	'continue',
	'continue-fn'
];
// END AUTO-GENERATED CODE

export const load = async () => {
	return {
		_loadedTranslations: _getTranslations(_translationKeys)
	};
};
```

## How to Test

1. **Start the dev server**: `npm run dev`
2. **Navigate to**: `/deep-scanning-test`
3. **Check the console** for deep scanning logs
4. **Verify** that `+page.server.ts` contains all translation keys
5. **Confirm** that the page renders with all translations working

## Key Benefits Demonstrated

âœ… **Deep Scanning**: Finds keys in components at any nesting level  
âœ… **Dependency Tracking**: Follows import chains automatically  
âœ… **Key Variants**: Detects both camelCase and kebab-case versions  
âœ… **Reserved Words**: Handles reserved words with Fn suffix  
âœ… **Real-time Updates**: Monitors all component changes

## Console Output Expected

When verbose mode is enabled, you should see logs like:

```
ğŸ” Processing route file: ./src/routes/deep-scanning-test/+page.svelte (deep-scanning-test)
ğŸ” Scanning component: ./src/routes/deep-scanning-test/+page.svelte
ğŸ“¦ Found 2 imports in ./src/routes/deep-scanning-test/+page.svelte
ğŸ”— Following import: ./DeepScanningComponent.svelte
ğŸ” Scanning component: ./DeepScanningComponent.svelte
ğŸ” Found 4 translation keys in ./DeepScanningComponent.svelte
âœ… Finished scanning ./DeepScanningComponent.svelte, total keys: 4
ğŸ”— Following import: ./NestedTranslationComponent.svelte
ğŸ” Scanning component: ./NestedTranslationComponent.svelte
ğŸ“¦ Found 1 imports in ./NestedTranslationComponent.svelte
ğŸ”— Following import: ./DeepNestedComponent.svelte
ğŸ” Scanning component: ./DeepNestedComponent.svelte
ğŸ” Found 5 translation keys in ./DeepNestedComponent.svelte
âœ… Finished scanning ./DeepNestedComponent.svelte, total keys: 5
âœ… Finished scanning ./NestedTranslationComponent.svelte, total keys: 8
âœ… Finished scanning ./+page.svelte, total keys: 10
ğŸ” Found 10 translation keys in ./+page.svelte (including dependencies)
```

This demonstrates that the plugin now works like a "rune time check" - it scans the entire component tree and finds all translation keys, regardless of how deeply nested they are!
